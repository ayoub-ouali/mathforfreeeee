<!DOCTYPE html>
<html lang="ar" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Windows Calculator Pro</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/11.6.0/math.js"></script>
    
    <style>
        /* أساسيات التصميم */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', system-ui, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #323130;
            height: 100vh;
            overflow: hidden;
        }
        
        /* شريط العنوان */
        .title-bar {
            height: 32px;
            background: #0078d4;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 10px;
            color: white;
        }
        
        .title-text {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .window-controls {
            display: flex;
            gap: 2px;
        }
        
        .win-btn {
            width: 46px;
            height: 32px;
            background: transparent;
            border: none;
            color: white;
            cursor: pointer;
        }
        
        .win-btn:hover { background: rgba(255,255,255,0.1); }
        .win-btn.close:hover { background: #e81123; }
        
        /* التبويبات الرئيسية */
        .main-tabs {
            display: flex;
            background: white;
            border-bottom: 1px solid #e1dfdd;
        }
        
        .main-tab {
            padding: 12px 20px;
            background: none;
            border: none;
            border-bottom: 3px solid transparent;
            cursor: pointer;
            color: #605e5c;
        }
        
        .main-tab:hover { background: #f3f2f1; color: #0078d4; }
        .main-tab.active { color: #0078d4; border-bottom-color: #0078d4; font-weight: 600; }
        
        /* الواجهة الرئيسية */
        .app-container {
            display: flex;
            height: calc(100vh - 32px - 49px);
        }
        
        /* لوحة المفاتيح اليسرى */
        .keyboard-section {
            width: 400px;
            background: white;
            border-right: 1px solid #e1dfdd;
            padding: 20px;
            display: flex;
            flex-direction: column;
        }
        
        .display-area {
            margin-bottom: 20px;
        }
        
        .function-input {
            width: 100%;
            height: 60px;
            padding: 15px;
            font-size: 20px;
            font-family: 'Consolas', monospace;
            border: 2px solid #8a8886;
            border-radius: 6px;
            background: #faf9f8;
        }
        
        .control-buttons {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .ctrl-btn {
            flex: 1;
            padding: 10px;
            background: #f3f2f1;
            border: 1px solid #8a8886;
            border-radius: 6px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .ctrl-btn:hover { background: #edebe9; }
        .ctrl-btn.primary { background: #0078d4; color: white; border-color: #0078d4; }
        .ctrl-btn.primary:hover { background: #106ebe; }
        .ctrl-btn.success { background: #107c10; color: white; border-color: #107c10; }
        .ctrl-btn.success:hover { background: #0e6b0e; }
        
        .keypad {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 10px;
            flex-grow: 1;
        }
        
        .calc-btn {
            height: 60px;
            border: 2px solid #8a8886;
            border-radius: 6px;
            background: #f3f2f1;
            font-size: 18px;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .calc-btn:hover {
            background: #edebe9;
            transform: translateY(-2px);
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }
        
        .calc-btn.operation { background: #d0e8ff; border-color: #0078d4; }
        .calc-btn.equals { background: #0078d4; color: white; border-color: #0078d4; font-weight: bold; }
        .calc-btn.scientific { background: #fff4ce; border-color: #ffb900; }
        .calc-btn.number { background: white; }
        
        /* منطقة الرسم البياني */
        .graph-section {
            flex: 1;
            display: flex;
            flex-direction: column;
            padding: 20px;
            background: white;
        }
        
        .graph-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .graph-title {
            font-size: 24px;
            font-weight: 600;
            color: #323130;
        }
        
        .graph-tools {
            display: flex;
            gap: 10px;
        }
        
        .tool-btn {
            padding: 10px 15px;
            background: #f3f2f1;
            border: 1px solid #8a8886;
            border-radius: 6px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .tool-btn:hover { background: #edebe9; }
        
        .graph-area {
            flex: 1;
            border: 1px solid #e1dfdd;
            border-radius: 6px;
            overflow: hidden;
        }
        
        #graph {
            width: 100%;
            height: 100%;
        }
        
        .coordinates {
            display: flex;
            gap: 20px;
            margin-top: 15px;
            font-size: 14px;
        }
        
        .coord {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        /* القائمة الجانبية */
        .sidebar {
            width: 300px;
            background: white;
            border-left: 1px solid #e1dfdd;
            display: flex;
            flex-direction: column;
        }
        
        .sidebar-tabs {
            display: flex;
            border-bottom: 1px solid #e1dfdd;
        }
        
        .sidebar-tab {
            flex: 1;
            padding: 15px;
            background: none;
            border: none;
            border-bottom: 3px solid transparent;
            cursor: pointer;
        }
        
        .sidebar-tab.active { border-bottom-color: #0078d4; color: #0078d4; font-weight: 600; }
        
        .sidebar-content {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
        }
        
        .tab-panel {
            display: none;
        }
        
        .tab-panel.active {
            display: block;
        }
        
        .functions-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .function-card {
            padding: 15px;
            background: #faf9f8;
            border: 1px solid #e1dfdd;
            border-radius: 6px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .func-color {
            width: 20px;
            height: 20px;
            border-radius: 50%;
        }
        
        .func-info {
            flex: 1;
        }
        
        .func-name {
            font-weight: 600;
            margin-bottom: 5px;
        }
        
        .func-expr {
            font-family: 'Consolas', monospace;
            font-size: 14px;
            color: #605e5c;
        }
        
        .func-actions {
            display: flex;
            gap: 5px;
        }
        
        .action-btn {
            width: 30px;
            height: 30px;
            border-radius: 4px;
            border: 1px solid #e1dfdd;
            background: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .action-btn:hover { background: #f3f2f1; }
        
        /* محول الوحدات */
        .converter {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .converter-row {
            display: flex;
            gap: 10px;
            align-items: center;
        }
        
        .converter-input {
            flex: 1;
            padding: 10px;
            border: 1px solid #8a8886;
            border-radius: 4px;
            font-size: 16px;
        }
        
        .converter-select {
            padding: 10px;
            border: 1px solid #8a8886;
            border-radius: 4px;
            background: white;
            min-width: 120px;
        }
        
        .converter-result {
            padding: 15px;
            background: #f3f2f1;
            border-radius: 6px;
            font-size: 18px;
            font-weight: 600;
            text-align: center;
        }
        
        /* الصيغ الرياضية */
        .formulas-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }
        
        .formula-card {
            padding: 15px;
            background: #faf9f8;
            border: 1px solid #e1dfdd;
            border-radius: 6px;
            cursor: pointer;
            text-align: center;
        }
        
        .formula-card:hover {
            background: #e6f3ff;
            border-color: #0078d4;
        }
        
        .formula-title {
            font-weight: 600;
            margin-bottom: 5px;
        }
        
        .formula-expr {
            font-family: 'Consolas', monospace;
            font-size: 14px;
            color: #605e5c;
        }
        
        /* التاريخ */
        .history-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .history-item {
            padding: 10px;
            background: #faf9f8;
            border: 1px solid #e1dfdd;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .history-item:hover {
            background: #f3f2f1;
        }
        
        /* شريط الحالة */
        .status-bar {
            height: 32px;
            background: white;
            border-top: 1px solid #e1dfdd;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 20px;
            font-size: 12px;
            color: #605e5c;
        }
        
        /* الإشعارات */
        .notification {
            position: fixed;
            bottom: 20px;
            right: 20px;
            padding: 15px 20px;
            background: #323130;
            color: white;
            border-radius: 6px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            z-index: 1000;
            animation: slideIn 0.3s;
        }
        
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        /* التكيف مع الشاشات */
        @media (max-width: 1200px) {
            .keyboard-section { width: 350px; }
            .sidebar { width: 250px; }
        }
        
        @media (max-width: 1024px) {
            .app-container { flex-direction: column; }
            .keyboard-section, .sidebar { width: 100%; height: 300px; }
        }




        /* تنسيقات خاصة بنظام الإخفاء/الإظهار */
.function-hidden {
    opacity: 0.6;
    background-color: #f8f8f8;
}

.visibility-controls {
    display: flex;
    gap: 8px;
    margin: 15px 0;
    padding: 10px;
    background: #faf9f8;
    border-radius: 8px;
    border: 1px solid #e1dfdd;
}

.visibility-btn {
    padding: 8px 12px;
    border-radius: 6px;
    border: 1px solid #e1dfdd;
    background: white;
    cursor: pointer;
    font-size: 14px;
    display: flex;
    align-items: center;
    gap: 6px;
    transition: all 0.2s;
}

.visibility-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 3px 8px rgba(0,0,0,0.1);
}

.visibility-btn.show-all {
    background: #e6f3ff;
    color: #0078d4;
    border-color: #0078d4;
}

.visibility-btn.hide-all {
    background: #ffe6e6;
    color: #d83b01;
    border-color: #d83b01;
}

.visibility-btn.toggle-trig {
    background: #fff4ce;
    color: #ffb900;
    border-color: #ffb900;
}

.visibility-btn.toggle-poly {
    background: #e6ffed;
    color: #107c10;
    border-color: #107c10;
}
    </style>
</head>
<body>
    <!-- شريط العنوان -->
    <div class="title-bar">
        <div class="title-text">
            <i class="fas fa-calculator"></i>
            <span>Windows Calculator Pro</span>
        </div>
        <div class="window-controls">
            <button class="win-btn minimize"><i class="fas fa-window-minimize"></i></button>
            <button class="win-btn maximize"><i class="fas fa-window-maximize"></i></button>
            <button class="win-btn close"><i class="fas fa-times"></i></button>
        </div>
    </div>
    
    <!-- التبويبات الرئيسية -->
    <div class="main-tabs">
        <button class="main-tab active" onclick="switchMainTab('graphing')">
            <i class="fas fa-chart-line"></i> Graphing
        </button>
        <button class="main-tab" onclick="switchMainTab('scientific')">
            <i class="fas fa-flask"></i> Scientific
        </button>
        <button class="main-tab" onclick="switchMainTab('formulas')">
            <i class="fas fa-square-root-alt"></i> Formulas
        </button>
        <button class="main-tab" onclick="switchMainTab('converter')">
            <i class="fas fa-exchange-alt"></i> Converter
        </button>
        <button class="main-tab" onclick="switchMainTab('history')">
            <i class="fas fa-history"></i> History
        </button>
    </div>
    
    <!-- الواجهة الرئيسية -->
    <div class="app-container">
        <!-- لوحة المفاتيح -->
        <div class="keyboard-section">
            <div class="display-area">
                <input type="text" class="function-input" id="functionInput" 
                       placeholder="Enter function (e.g., x^2, sin(x), 2*x+1)">
            </div>
            
            <div class="control-buttons">
                <button class="ctrl-btn" onclick="clearFunction()">
                    <i class="fas fa-eraser"></i> Clear
                </button>
                <button class="ctrl-btn success" onclick="plotFunction()">
                    <i class="fas fa-chart-line"></i> Plot
                </button>
                <button class="ctrl-btn primary" onclick="addNewFunction()">
                    <i class="fas fa-plus"></i> New
                </button>
                <button class="ctrl-btn" onclick="toggleEditMode()" id="editBtn">
                    <i class="fas fa-edit"></i> Edit
                </button>
            </div>
            
            <!-- لوحة المفاتيح الرياضية -->
            <div class="keypad" id="calculatorKeypad">
                <!-- سيتم ملؤها بواسطة JavaScript -->
            </div>
        </div>
        
        <!-- منطقة الرسم البياني -->
        <div class="graph-section">
            <div class="graph-header">
                <div class="graph-title">Function Grapher</div>
                <div class="graph-tools">
                    <button class="tool-btn" onclick="zoomIn()">
                        <i class="fas fa-search-plus"></i> Zoom In
                    </button>
                    <button class="tool-btn" onclick="zoomOut()">
                        <i class="fas fa-search-minus"></i> Zoom Out
                    </button>
                    <button class="tool-btn" onclick="resetView()">
                        <i class="fas fa-expand-arrows-alt"></i> Reset
                    </button>
                    <button class="tool-btn" onclick="exportGraph()">
                        <i class="fas fa-download"></i> Export
                    </button>
                </div>
            </div>
            
            <div class="graph-area">
                <div id="graph"></div>
            </div>
            
            <div class="coordinates">
                <div class="coord">
                    <span>X:</span>
                    <span id="coordX">0.000</span>
                </div>
                <div class="coord">
                    <span>Y:</span>
                    <span id="coordY">0.000</span>
                </div>
                <div class="coord">
                    <span>Functions:</span>
                    <span id="funcCount">0</span>
                </div>
            </div>
        </div>
        
        <!-- القائمة الجانبية -->
        <div class="sidebar">
            <div class="sidebar-tabs">
                <button class="sidebar-tab active" onclick="switchSidebarTab('functions')">
                    <i class="fas fa-functions"></i>
                </button>
                <button class="sidebar-tab" onclick="switchSidebarTab('formulas')">
                    <i class="fas fa-square-root-alt"></i>
                </button>
                <button class="sidebar-tab" onclick="switchSidebarTab('converter')">
                    <i class="fas fa-exchange-alt"></i>
                </button>
                <button class="sidebar-tab" onclick="switchSidebarTab('history')">
                    <i class="fas fa-history"></i>
                </button>
            </div>
            
            <div class="sidebar-content">
                <!-- تبويب الدوال -->
                <div class="tab-panel active" id="functionsPanel">
                    <h3 style="margin-bottom: 15px;">Graph Functions</h3>
                    <div class="functions-list" id="functionsList">
                        <!-- الدوال تضاف هنا -->
                    </div>
                </div>
                
                <!-- تبويب الصيغ -->
                <div class="tab-panel" id="formulasPanel">
                    <h3 style="margin-bottom: 15px;">Math Formulas</h3>
                    <div class="formulas-grid">
                        <div class="formula-card" onclick="insertFormula('x = [-b ± √(b²-4ac)]/(2a)')">
                            <div class="formula-title">Quadratic Formula</div>
                            <div class="formula-expr">x = [-b ± √(b²-4ac)]/(2a)</div>
                        </div>
                        <div class="formula-card" onclick="insertFormula('a² + b² = c²')">
                            <div class="formula-title">Pythagoras</div>
                            <div class="formula-expr">a² + b² = c²</div>
                        </div>
                        <div class="formula-card" onclick="insertFormula('F = m·a')">
                            <div class="formula-title">Newton's Law</div>
                            <div class="formula-expr">F = m·a</div>
                        </div>
                        <div class="formula-card" onclick="insertFormula('E = m·c²')">
                            <div class="formula-title">Einstein</div>
                            <div class="formula-expr">E = m·c²</div>
                        </div>
                        <div class="formula-card" onclick="insertFormula('A = π·r²')">
                            <div class="formula-title">Circle Area</div>
                            <div class="formula-expr">A = π·r²</div>
                        </div>
                        <div class="formula-card" onclick="insertFormula('V = π·r²·h')">
                            <div class="formula-title">Cylinder Volume</div>
                            <div class="formula-expr">V = π·r²·h</div>
                        </div>
                    </div>
                </div>
                
                <!-- تبويب المحول -->
                <div class="tab-panel" id="converterPanel">
                    <h3 style="margin-bottom: 15px;">Unit Converter</h3>
                    <div class="converter">
                        <div class="converter-row">
                            <input type="number" class="converter-input" id="convValue" value="1" step="any">
                            <select class="converter-select" id="convFrom">
                                <option value="meter">Meter</option>
                                <option value="kilometer">Kilometer</option>
                                <option value="centimeter">Centimeter</option>
                                <option value="mile">Mile</option>
                            </select>
                        </div>
                        
                        <div class="converter-row">
                            <span style="font-size: 20px;">→</span>
                        </div>
                        
                        <div class="converter-row">
                            <div class="converter-result" id="convResult">100 cm</div>
                            <select class="converter-select" id="convTo">
                                <option value="meter">Meter</option>
                                <option value="kilometer" selected>Kilometer</option>
                                <option value="centimeter">Centimeter</option>
                                <option value="mile">Mile</option>
                            </select>
                        </div>
                        
                        <button class="ctrl-btn primary" onclick="convertUnits()">
                            <i class="fas fa-sync-alt"></i> Convert
                        </button>
                    </div>
                </div>
                
                <!-- تبويب التاريخ -->
                <div class="tab-panel" id="historyPanel">
                    <h3 style="margin-bottom: 15px; display: flex; justify-content: space-between;">
                        <span>History</span>
                        <button class="action-btn" onclick="clearHistory()" title="Clear History">
                            <i class="fas fa-trash"></i>
                        </button>
                    </h3>
                    <div class="history-list" id="historyList">
                        <!-- التاريخ يضاف هنا -->
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- شريط الحالة -->
    <div class="status-bar">
        <div>
            <span id="statusMessage">Ready - Enter a function to graph</span>
        </div>
        <div>
            <span id="currentTime">00:00:00</span>
        </div>
    </div>
    
    <!-- ملف JavaScript المنفصل -->
    <script src="graph-js.js"></script>
    
    <script>
        // كود تهيئة سريع
        document.addEventListener('DOMContentLoaded', function() {
            // تحديث الوقت
            function updateTime() {
                const now = new Date();
                document.getElementById('currentTime').textContent = 
                    now.toLocaleTimeString();
            }
            setInterval(updateTime, 1000);
            updateTime();
            
            // التحكم بالنوافذ
            document.querySelector('.win-btn.minimize').onclick = function() {
                showNotification('Minimized');
            };
            
            document.querySelector('.win-btn.maximize').onclick = function() {
                showNotification('Maximized');
            };
            
            document.querySelector('.win-btn.close').onclick = function() {
                if (confirm('Close Calculator?')) {
                    showNotification('Calculator closed');
                    setTimeout(() => {
                        document.body.innerHTML = '<h1 style="padding: 50px; text-align: center;">Calculator Closed</h1>';
                    }, 500);
                }
            };
            
            // تحويل الوحدات عند التغيير
            document.getElementById('convValue').addEventListener('input', convertUnits);
            document.getElementById('convFrom').addEventListener('change', convertUnits);
            document.getElementById('convTo').addEventListener('change', convertUnits);
        });
        
        // وظيفة الإشعارات
        function showNotification(message) {
            const notification = document.createElement('div');
            notification.className = 'notification';
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }
    </script>
</body>
</html>